#!/usr/bin/env perl
use 5.14.0;
use warnings;
use utf8::all;
use Anki::Corpus;

my $query = shift
    or die "usage: $0 query\n";

my $corpus = Anki::Corpus->new;
my $count = $corpus->print_each("WHERE $query");

if ($count) {
    $| = 1;
    print "Are you sure you want to delete these $count rows? [yN] ";
    exit unless <> =~ /^y/i;

    my $sth = $corpus->prepare("
        DELETE
        FROM sentences
        WHERE $query
    ;");
    $sth->execute;
}
else {
    say "No matches.";
}
